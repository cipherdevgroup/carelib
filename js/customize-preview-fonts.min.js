!function(e,t,i,n,o,s){"use strict";var l=o.customize,a={},d=[],r=carelibFontsPreviewSettings;i.extend(a,{model:{},view:{}}),a.model.Group=n.Model.extend({defaults:{id:"",family:"",selector:"",service:"google",stack:"",variations:""},initialize:function(){this.listenTo(this,"change:family",this.loadFont)},loadFont:function(){var e={events:!1,classes:!1},t=this.get("family"),i=this.get("service"),n=l("carelib_fonts_typekit_id")();"google"===i&&""!==t&&(e.google={families:[this.getGoogleFamilyDefinition()]}),"typekit"===i&&""!==n&&(e.typekit={id:n}),a.loadFont(e)},getGoogleFamilyDefinition:function(){var e=this.get("family"),t=this.get("variations");return""!==t&&(e+=":"+t),""!==r.subsets&&"latin"!==r.subsets&&(e+=":"+r.subsets),e}}),a.view.Style=o.Backbone.View.extend({tagName:"style",initialize:function(){this.model=this.options.model,this.listenTo(this.model,"change:stack",this.render)},render:function(){var e="",t=this.model.get("stack"),i=this.model.get("selector");return""!==t&&(e=i+" { font-family: "+t+";}"),this.$el.html(e),this}}),a.loadFont=function(e){var t=JSON.stringify(e);e&&-1===d.indexOf(t)&&(WebFont.load(e),d.push(t))},l.bind("preview-ready",function(){var e=t("head");i.each(r.groups,function(t){var i,n=new a.model.Group(t),o=l(t.id+"_font")();o&&n.set(o),i=new a.view.Style({model:n}),e.append(i.render().$el),l(t.id+"_font",function(e){e.bind(function(e){n.set(e)})})})})}(window,jQuery,_,Backbone,wp);